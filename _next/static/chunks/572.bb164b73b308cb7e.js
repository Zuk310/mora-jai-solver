(()=>{"use strict";class r{constructor(r=[],t=(r,t)=>r<t?-1:+(r>t)){if(this.data=r,this.length=this.data.length,this.compare=t,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(r){this.data.push(r),this._up(this.length++)}pop(){if(0===this.length)return;let r=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),r}peek(){return this.data[0]}_up(r){let{data:t,compare:e}=this,c=t[r];for(;r>0;){let l=r-1>>1,i=t[l];if(e(c,i)>=0)break;t[r]=i,r=l}t[r]=c}_down(r){let{data:t,compare:e}=this,c=this.length>>1,l=t[r];for(;r<c;){let c=(r<<1)+1,i=c+1;if(i<this.length&&0>e(t[i],t[c])&&(c=i),e(t[c],l)>=0)break;t[r]=t[c],r=c}t[r]=l}}var t=function(r){return r.GREY="Grey",r.BLACK="Black",r.GREEN="Green",r.PINK="Pink",r.YELLOW="Yellow",r.VIOLET="Violet",r.WHITE="White",r.RED="Red",r.ORANGE="Orange",r.BLUE="Blue",r}({});let e=r=>r.map(r=>[...r]),c=r=>JSON.stringify(r),l=(r,t)=>r[0][0]===t.topLeft&&r[0][2]===t.topRight&&r[2][0]===t.bottomLeft&&r[2][2]===t.bottomRight,i={"0,0":0,"0,1":1,"0,2":2,"1,0":3,"1,1":4,"1,2":5,"2,0":6,"2,1":7,"2,2":8},a=[[{r:0,c:1},{r:1,c:1},{r:1,c:0}],[{r:0,c:2},{r:1,c:2},{r:2,c:2},{r:2,c:1},{r:2,c:0},{r:1,c:0},{r:0,c:0}],[{r:1,c:2},{r:2,c:2},{r:2,c:1},{r:1,c:1},{r:0,c:1}],[{r:0,c:0},{r:0,c:1},{r:1,c:1},{r:2,c:1},{r:2,c:0}],[{r:0,c:0},{r:0,c:1},{r:0,c:2},{r:1,c:2},{r:2,c:2},{r:2,c:1},{r:2,c:0},{r:1,c:0}],[{r:2,c:2},{r:2,c:1},{r:1,c:1},{r:0,c:1},{r:0,c:2}],[{r:1,c:0},{r:1,c:1},{r:2,c:1}],[{r:2,c:0},{r:1,c:0},{r:1,c:1},{r:1,c:2},{r:2,c:2}],[{r:1,c:2},{r:1,c:1},{r:2,c:1}]],h=[[{r:0,c:1},{r:1,c:0}],[{r:0,c:0},{r:0,c:2},{r:1,c:1}],[{r:0,c:1},{r:1,c:2}],[{r:0,c:0},{r:1,c:1},{r:2,c:0}],[{r:0,c:1},{r:1,c:0},{r:1,c:2},{r:2,c:1}],[{r:0,c:2},{r:1,c:1},{r:2,c:2}],[{r:1,c:0},{r:2,c:1}],[{r:1,c:1},{r:2,c:0},{r:2,c:2}],[{r:1,c:2},{r:2,c:1}]],n=(r,c,l,f)=>{let g=e(r),E=i["".concat(c,",").concat(l)];switch(f){case t.GREY:break;case t.BLACK:let p=g[c],u=p.pop();p.unshift(u);break;case t.GREEN:if(1===c&&1===l)break;let L=2-c,b=2-l;[g[c][l],g[L][b]]=[g[L][b],g[c][l]];break;case t.PINK:let d=a[E];d&&d.length>0&&o(g,d);break;case t.YELLOW:c>0&&([g[c][l],g[c-1][l]]=[g[c-1][l],g[c][l]]);break;case t.VIOLET:c<2&&([g[c][l],g[c+1][l]]=[g[c+1][l],g[c][l]]);break;case t.WHITE:let k=r[c][l],R=h[E];g[c][l]=s(k,k,t.GREY),R&&R.forEach(e=>{let c=r[e.r][e.c];g[e.r][e.c]=s(c,k,t.GREY)});break;case t.RED:for(let r=0;r<3;r++)for(let e=0;e<3;e++)g[r][e]===t.WHITE?g[r][e]=t.BLACK:g[r][e]===t.BLACK&&(g[r][e]=t.RED);break;case t.ORANGE:let B=h[E];if(B&&B.length>0){let t={};B.forEach(e=>{let c=r[e.r][e.c];t[c]=(t[c]||0)+1});let e=null,i=0,a=!0;for(let r in t)t[r]>i?(i=t[r],e=r,a=!0):t[r]===i&&(a=!1);a&&e&&(g[c][l]=e)}break;case t.BLUE:let G=r[1][1];G!==t.BLUE&&(g=n(g,c,l,G))}return g},o=(r,t)=>{if(0===t.length)return;let e=r[t[t.length-1].r][t[t.length-1].c];for(let e=t.length-1;e>0;e--)r[t[e].r][t[e].c]=r[t[e-1].r][t[e-1].c];r[t[0].r][t[0].c]=e},s=(r,t,e)=>r===t?e:r===e?t:r;function f(r,t){let e=0;return r[0][0]!==t.topLeft&&e++,r[0][2]!==t.topRight&&e++,r[2][0]!==t.bottomLeft&&e++,r[2][2]!==t.bottomRight&&e++,e}self.onmessage=i=>{let{grid:a,realmColors:h}=i.data,o=function(i,a){let h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e7,o=new r([{grid:e(i),path:[],priority:f(i,a)}],(r,t)=>r.priority-t.priority),s=new Set([c(i)]),g=0;for(;o.length>0&&g<h;){let r=o.pop();if(!r)break;let{grid:i,path:E}=r;if(g++,l(i,a))return{solution:E,iterations:g};if(g>=h)break;if(!(E.length>=25))for(let r=0;r<3;r++)for(let l=0;l<3;l++){let h=i[r][l],g=h===t.BLUE?i[1][1]:h;if(h!==t.BLUE||i[1][1]!==t.BLUE)try{let t=n(e(i),r,l,g),h=c(t);if(!s.has(h)){s.add(h);let e=E.length+1,c=f(t,a);o.push({grid:t,path:[...E,{r,c:l}],priority:e+c})}}catch(r){continue}}}return{solution:null,iterations:g}}(a,h);self.postMessage(o)}})(),_N_E={};