(()=>{"use strict";class t{constructor(t=[],e=(t,e)=>t<e?-1:+(t>e)){if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let t=(this.length>>1)-1;t>=0;t--)this._down(t)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(0===this.length)return;let t=this.data[0],e=this.data.pop();return--this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){let{data:e,compare:r}=this,l=e[t];for(;t>0;){let c=t-1>>1,i=e[c];if(r(l,i)>=0)break;e[t]=i,t=c}e[t]=l}_down(t){let{data:e,compare:r}=this,l=this.length>>1,c=e[t];for(;t<l;){let l=(t<<1)+1,i=l+1;if(i<this.length&&0>r(e[i],e[l])&&(l=i),r(e[l],c)>=0)break;e[t]=e[l],t=l}e[t]=c}}var e=function(t){return t.GREY="Grey",t.BLACK="Black",t.GREEN="Green",t.PINK="Pink",t.YELLOW="Yellow",t.VIOLET="Violet",t.WHITE="White",t.RED="Red",t.ORANGE="Orange",t.BLUE="Blue",t}({});let r=t=>t.map(t=>[...t]),l=t=>JSON.stringify(t),c=(t,e)=>t[0][0]===e.topLeft&&t[0][2]===e.topRight&&t[2][0]===e.bottomLeft&&t[2][2]===e.bottomRight,i={"0,0":0,"0,1":1,"0,2":2,"1,0":3,"1,1":4,"1,2":5,"2,0":6,"2,1":7,"2,2":8},a=[{dr:-1,dc:-1},{dr:-1,dc:0},{dr:-1,dc:1},{dr:0,dc:1},{dr:1,dc:1},{dr:1,dc:0},{dr:1,dc:-1},{dr:0,dc:-1}],o=Array(9).fill(null).map(()=>[]);for(let t=0;t<3;t++)for(let e=0;e<3;e++){let r=i["".concat(t,",").concat(e)],l=[];for(let r of a){let c=t+r.dr,i=e+r.dc;c>=0&&c<3&&i>=0&&i<3&&l.push({r:c,c:i})}o[r]=l}let n=[[{r:0,c:1},{r:1,c:0}],[{r:0,c:0},{r:0,c:2},{r:1,c:1}],[{r:0,c:1},{r:1,c:2}],[{r:0,c:0},{r:1,c:1},{r:2,c:0}],[{r:0,c:1},{r:1,c:0},{r:1,c:2},{r:2,c:1}],[{r:0,c:2},{r:1,c:1},{r:2,c:2}],[{r:1,c:0},{r:2,c:1}],[{r:1,c:1},{r:2,c:0},{r:2,c:2}],[{r:1,c:2},{r:2,c:1}]],h=(t,l,c,a)=>{let d=r(t),g=i["".concat(l,",").concat(c)];switch(a){case e.GREY:break;case e.BLACK:let p=d[l],E=p.pop();p.unshift(E);break;case e.GREEN:if(1===l&&1===c)break;let u=2-l,L=2-c;[d[l][c],d[u][L]]=[d[u][L],d[l][c]];break;case e.PINK:let b=o[g];b&&b.length>0&&s(d,b);break;case e.YELLOW:l>0&&([d[l][c],d[l-1][c]]=[d[l-1][c],d[l][c]]);break;case e.VIOLET:l<2&&([d[l][c],d[l+1][c]]=[d[l+1][c],d[l][c]]);break;case e.WHITE:let k=t[l][c],R=n[g];d[l][c]=f(k,k,e.GREY),R&&R.forEach(r=>{let l=t[r.r][r.c];d[r.r][r.c]=f(l,k,e.GREY)});break;case e.RED:for(let t=0;t<3;t++)for(let r=0;r<3;r++)d[t][r]===e.WHITE?d[t][r]=e.BLACK:d[t][r]===e.BLACK&&(d[t][r]=e.RED);break;case e.ORANGE:let B=n[g];if(B&&B.length>0){let e={};B.forEach(r=>{let l=t[r.r][r.c];e[l]=(e[l]||0)+1});let r=null,i=0,a=!0;for(let t in e)e[t]>i?(i=e[t],r=t,a=!0):e[t]===i&&(a=!1);a&&r&&(d[l][c]=r)}break;case e.BLUE:let G=t[1][1];G!==e.BLUE&&(d=h(d,l,c,G))}return d},s=(t,e)=>{if(0===e.length)return;let r=t[e[e.length-1].r][e[e.length-1].c];for(let r=e.length-1;r>0;r--)t[e[r].r][e[r].c]=t[e[r-1].r][e[r-1].c];t[e[0].r][e[0].c]=r},f=(t,e,r)=>t===e?r:t===r?e:t;function d(t,e){let r=0;return t[0][0]!==e.topLeft&&r++,t[0][2]!==e.topRight&&r++,t[2][0]!==e.bottomLeft&&r++,t[2][2]!==e.bottomRight&&r++,r}self.onmessage=i=>{let{grid:a,realmColors:o}=i.data,n=function(i,a){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e7,n=new t([{grid:r(i),path:[],priority:d(i,a)}],(t,e)=>t.priority-e.priority),s=new Set([l(i)]),f=0;for(;n.length>0&&f<o;){let t=n.pop();if(!t)break;let{grid:i,path:g}=t;if(f++,c(i,a))return{solution:g,iterations:f};if(f>=o)break;if(!(g.length>=35))for(let t=0;t<3;t++)for(let c=0;c<3;c++){let o=i[t][c],f=o===e.BLUE?i[1][1]:o;if(o!==e.BLUE||i[1][1]!==e.BLUE)try{let e=h(r(i),t,c,f),o=l(e);if(!s.has(o)){s.add(o);let r=g.length+1,l=d(e,a);n.push({grid:e,path:[...g,{r:t,c}],priority:r+l})}}catch(t){continue}}}return{solution:null,iterations:f}}(a,o);self.postMessage(n)}})(),_N_E={};